# Initialize model
model = TwinTowerGRUModel(
    embedding_dim=100,  # GloVe dimension
    hidden_dim=128,     # Hidden state size
    output_dim=128,     # Final embedding size
    num_layers=1,       # Single layer for simplicity
    dropout=0.1         # Light dropout
)

# Load GloVe embeddings
glove_embeddings = torch.load('downloaded_model/glove_embeddings.pt')

# Process a batch
query_vectors, doc_vectors = model(
    query_embeddings, query_lengths,
    doc_embeddings, doc_lengths
)

# Calculate similarity
similarity_scores = torch.sum(query_vectors * doc_vectors, dim=1)